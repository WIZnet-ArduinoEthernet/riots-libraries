<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Riots libraries: Riots_Flash Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="riots_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Riots libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classRiots__Flash-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Riots_Flash Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a416f748349335bc7b3b83b2c63a85597"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a416f748349335bc7b3b83b2c63a85597">handleFlashMessage</a> (uint8_t type, uint8_t *plain, bool *response_needed)</td></tr>
<tr class="separator:a416f748349335bc7b3b83b2c63a85597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d445aba5c3959c4c0960bb0e03cc83"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a56d445aba5c3959c4c0960bb0e03cc83">setup</a> ()</td></tr>
<tr class="separator:a56d445aba5c3959c4c0960bb0e03cc83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a394413fc48b88f704b0938998de249eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a394413fc48b88f704b0938998de249eb">writeEepromPage</a> ()</td></tr>
<tr class="separator:a394413fc48b88f704b0938998de249eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af413b1e5ebf2b9b6810fee47463596c2"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#af413b1e5ebf2b9b6810fee47463596c2">page_address</a></td></tr>
<tr class="separator:af413b1e5ebf2b9b6810fee47463596c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea01fc292693fa4488b45d3371d02144"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#aea01fc292693fa4488b45d3371d02144">page_address_previous</a></td></tr>
<tr class="separator:aea01fc292693fa4488b45d3371d02144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f36bcdc375be8a4efd15803d43f550a"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a1f36bcdc375be8a4efd15803d43f550a">i2c_offset</a></td></tr>
<tr class="separator:a1f36bcdc375be8a4efd15803d43f550a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f147e717e97767914e961d7d295bbb0"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a5f147e717e97767914e961d7d295bbb0">flash_buffer</a> [128]</td></tr>
<tr class="separator:a5f147e717e97767914e961d7d295bbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05512b7458f15deb85e7004272a1b6a7"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a05512b7458f15deb85e7004272a1b6a7">firmware_size</a></td></tr>
<tr class="separator:a05512b7458f15deb85e7004272a1b6a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e1133fa9f089253479ec851b4f3f5b0"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a5e1133fa9f089253479ec851b4f3f5b0">firmware_written</a></td></tr>
<tr class="separator:a5e1133fa9f089253479ec851b4f3f5b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1399a92339dbb649df471a35868ab6f"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#ae1399a92339dbb649df471a35868ab6f">packet_counter</a></td></tr>
<tr class="separator:ae1399a92339dbb649df471a35868ab6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a998caf3d51c5090a1f441e5ce6ab4140"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a998caf3d51c5090a1f441e5ce6ab4140">flashbuffer_index</a></td></tr>
<tr class="separator:a998caf3d51c5090a1f441e5ce6ab4140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bc3b906d253ba32b9f8e46f529c9a71"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a2bc3b906d253ba32b9f8e46f529c9a71">next_boot_status</a></td></tr>
<tr class="separator:a2bc3b906d253ba32b9f8e46f529c9a71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64be1805c097f8bcea6d53be5ff60997"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a64be1805c097f8bcea6d53be5ff60997">eeprom_status</a></td></tr>
<tr class="separator:a64be1805c097f8bcea6d53be5ff60997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0576e99e68f225d3e7191d1f215cc8a2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a0576e99e68f225d3e7191d1f215cc8a2">reported</a></td></tr>
<tr class="separator:a0576e99e68f225d3e7191d1f215cc8a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0230c61c55bd15fad1e364bed1078bf7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a0230c61c55bd15fad1e364bed1078bf7">new_page</a></td></tr>
<tr class="separator:a0230c61c55bd15fad1e364bed1078bf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099c30e93df23d6231ed681db35087b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRiots__Memory.html">Riots_Memory</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRiots__Flash.html#a099c30e93df23d6231ed681db35087b3">riots_memory</a></td></tr>
<tr class="separator:a099c30e93df23d6231ed681db35087b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a416f748349335bc7b3b83b2c63a85597"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Riots_Flash::handleFlashMessage </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>response_needed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup function sets given ce, csn, irq and reset pins. If arguments are not given function reads pin values from EEPROM If pin values are not found from EEPROM, function sets hardcoded values (v05)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Type of the message </td></tr>
    <tr><td class="paramname">plain</td><td>Message in the plain text </td></tr>
    <tr><td class="paramname">response_needed</td><td>Will be set to true, if RIOTS product needs to reply to this message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>reset_pin RIOTS_OK, if the message was correct and handled </dd></dl>

</div>
</div>
<a class="anchor" id="a56d445aba5c3959c4c0960bb0e03cc83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Riots_Flash::setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup flash library.</p>
<dl class="section return"><dt>Returns</dt><dd>reset_pin RIOTS_OK, if the flash library is initialized correctly. </dd></dl>

</div>
</div>
<a class="anchor" id="a394413fc48b88f704b0938998de249eb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Riots_Flash::writeEepromPage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Writes page to the EEPROM. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a64be1805c097f8bcea6d53be5ff60997"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Riots_Flash::eeprom_status</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Status of external EEPROM (connected or not) </p>

</div>
</div>
<a class="anchor" id="a05512b7458f15deb85e7004272a1b6a7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Riots_Flash::firmware_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Size of the firmware image to be written to EEPROM </p>

</div>
</div>
<a class="anchor" id="a5e1133fa9f089253479ec851b4f3f5b0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Riots_Flash::firmware_written</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Amount of uint8_ts to written to EEPROM </p>

</div>
</div>
<a class="anchor" id="a5f147e717e97767914e961d7d295bbb0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Riots_Flash::flash_buffer[128]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Buffer to store data to be written to EEPROM </p>

</div>
</div>
<a class="anchor" id="a998caf3d51c5090a1f441e5ce6ab4140"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Riots_Flash::flashbuffer_index</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Index of uint8_t to be copied to flash_buffer </p>

</div>
</div>
<a class="anchor" id="a1f36bcdc375be8a4efd15803d43f550a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Riots_Flash::i2c_offset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Address offset (depending on do we write official or unofficial image </p>

</div>
</div>
<a class="anchor" id="a0230c61c55bd15fad1e364bed1078bf7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Riots_Flash::new_page</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Do we have started a new page writing </p>

</div>
</div>
<a class="anchor" id="a2bc3b906d253ba32b9f8e46f529c9a71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Riots_Flash::next_boot_status</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tells what will be the next boot mode (BOOT_LOAD_OFFICIAL, _UNOFFICIAL OR _FAILSAFE) </p>

</div>
</div>
<a class="anchor" id="ae1399a92339dbb649df471a35868ab6f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Riots_Flash::packet_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Index of next packet to be received with STK_PROG_PAGE </p>

</div>
</div>
<a class="anchor" id="af413b1e5ebf2b9b6810fee47463596c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Riots_Flash::page_address</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Address of page to write next </p>

</div>
</div>
<a class="anchor" id="aea01fc292693fa4488b45d3371d02144"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Riots_Flash::page_address_previous</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Address of previously written page </p>

</div>
</div>
<a class="anchor" id="a0576e99e68f225d3e7191d1f215cc8a2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Riots_Flash::reported</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Do we have already reported status of the package to the cloud </p>

</div>
</div>
<a class="anchor" id="a099c30e93df23d6231ed681db35087b3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRiots__Memory.html">Riots_Memory</a> Riots_Flash::riots_memory</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Instance of the RIOTS memory class </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>riots-libraries/Riots_Flash/<a class="el" href="Riots__Flash_8h_source.html">Riots_Flash.h</a></li>
<li>riots-libraries/Riots_Flash/Riots_Flash.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 22 2016 14:52:43 for Riots libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
